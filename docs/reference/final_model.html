<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Joins ENM from several partitions, creating a model per algorithm — final_model • modleR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Joins ENM from several partitions, creating a model per algorithm — final_model"><meta property="og:description" content="This function reads the models generated either by do_any or
do_many (i.e. one model per partition per algorithm) and
summarizes them into a final model for each species-algorithm combination.
All the final models are created from the mean of the raw continuous models
(raw_mean). From these means, several
outputs can be created, see which_models for details about
the final outputs available. The uncertainty between partitions, taken as
ranges (maximum - minimum values) between partitions may also be calculated.
Just as there are no silver bullets in correlative ecological niche
modeling, no method for presenting this models is always better
and these are only a subset of the possibilities."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-162793833-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-162793833-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">modleR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/modleR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/buffer_and_randomPoints.html">Testing background point generation in modleR</a>
    </li>
    <li>
      <a href="../articles/projection.html">Projecting models in modleR</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Model-R/modleR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Joins ENM from several partitions, creating a model per algorithm</h1>
    <small class="dont-index">Source: <a href="https://github.com/Model-R/modleR/blob/HEAD/R/final_model.R" class="external-link"><code>R/final_model.R</code></a></small>
    <div class="hidden name"><code>final_model.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function reads the models generated either by <code><a href="model_fit.html">do_any</a></code> or
<code><a href="model_fit.html">do_many</a></code> (i.e. one model per partition per algorithm) and
summarizes them into a final model for each species-algorithm combination.
All the final models are created from the mean of the raw continuous models
(<code>raw_mean</code>). From these means, several
outputs can be created, see <code>which_models</code> for details about
the final outputs available. The uncertainty between partitions, taken as
ranges (maximum - minimum values) between partitions may also be calculated.
Just as there are <em>no silver bullets in correlative ecological niche
modeling</em>, no method for presenting this models is always better
and these are only a subset of the possibilities.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">final_model</span><span class="op">(</span><span class="va">species_name</span>, algorithms <span class="op">=</span> <span class="cn">NULL</span>, scale_models <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  consensus_level <span class="op">=</span> <span class="fl">0.5</span>, models_dir <span class="op">=</span> <span class="st">"./models"</span>,</span>
<span>  final_dir <span class="op">=</span> <span class="st">"final_models"</span>, proj_dir <span class="op">=</span> <span class="st">"present"</span>,</span>
<span>  which_models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"raw_mean"</span><span class="op">)</span>, mean_th_par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"spec_sens"</span><span class="op">)</span>,</span>
<span>  uncertainty <span class="op">=</span> <span class="cn">FALSE</span>, png_final <span class="op">=</span> <span class="cn">TRUE</span>, sensitivity <span class="op">=</span> <span class="fl">0.9</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>species_name</dt>
<dd><p>A character string with the species name. Because species
name will be used as a directory name, avoid non-ASCII characters, spaces and
punctuation marks.
Recommendation is to adopt "Genus_species" format. See names in
<code><a href="example_occs.html">example_occs</a></code> as an example</p></dd>


<dt>algorithms</dt>
<dd><p>Character vector specifying which algorithms will be
processed. Note that it can have length &gt; 1, ex. <code>c("bioclim", "rf")</code>.
Defaults to NULL: if no name is given it will process all algorithms present
in the evaluation files</p></dd>


<dt>scale_models</dt>
<dd><p>Logical. Whether input models should be scaled between 0
and 1</p></dd>


<dt>consensus_level</dt>
<dd><p>Which proportion of binary models will be kept when
creating <code>bin_consensus</code></p></dd>


<dt>models_dir</dt>
<dd><p>Character. Folder path where the input files are located</p></dd>


<dt>final_dir</dt>
<dd><p>Character. Name of the folder to save the output files. A
subfolder will be created, defaults to "final_model"</p></dd>


<dt>proj_dir</dt>
<dd><p>Character. The name of the subfolder with the projection.
Defaults to "present" but can be set according to the other projections (i.e.
to execute the function in projected models)</p></dd>


<dt>which_models</dt>
<dd><p>Which <code>final_model</code> will be used? Currently it can
be:</p><dl><dt><code>raw_mean</code></dt>
<dd><p>Continuous model generated by the mean of the raw
  models (scale from 0 to 1)</p></dd>

  <dt><code>raw_mean_th</code></dt>
<dd><p>Cuts the <code>raw_mean</code> by the mean of the
  threshold selected in <code>mean_th_par</code> to make a binary model</p></dd>

   <dt><code>raw_mean_cut</code></dt>
<dd><p>Recovers <code>raw_mean</code> values above the
   threshold selected in <code>mean_th_par</code>. Generates a continuous model
   above this threshold while keeping null values below it</p></dd>

  <dt><code>bin_mean</code></dt>
<dd><p>The mean of the binary models, created by cutting
  the raw mean models by the threshold selected in <code>mean_th_par</code>.
  Generates a model in a discrete scale (0 to 1 in 1/n intervals where n is
  the number of partitions)</p></dd>

  <dt><code>bin_consensus</code></dt>
<dd><p>The binary consensus from <code>bin_mean</code>.
  Parameter <code>consensus_level</code> must be defined, 0.5 means a majority
  consensus</p></dd>


</dl></dd>


<dt>mean_th_par</dt>
<dd><p>A threshold that will be used to cut the raw mean models
if <code>which_models</code> is set to "<code>raw_mean_th</code>" or to transform the raw
mean models into binary models if <code>which_models</code> is set to
"<code>bin_consensus</code>". Defaults to "<code>spec_sens</code>" but any <span class="pkg">dismo</span>
threshold can be used (see function <code><a href="https://rdrr.io/pkg/dismo/man/threshold.html" class="external-link">threshold</a></code>):
"<code>kappa</code>", "<code>no_omission</code>", "<code>prevalence</code>",
"<code>equal_spec_sens</code>", "<code>sensitivity</code>"</p></dd>


<dt>uncertainty</dt>
<dd><p>Whether an uncertainty map, measured as range (max-min)
should be calculated</p></dd>


<dt>png_final</dt>
<dd><p>Logical. If <code>TRUE</code>, writes png files of the final
models</p></dd>


<dt>sensitivity</dt>
<dd><p>The sensitivity value for threshold "<code>sensitivity</code>".
Defaults to 0.9</p></dd>


<dt>...</dt>
<dd><p>Other parameters from <code><a href="https://rdrr.io/pkg/terra/man/writeRaster.html" class="external-link">writeRaster</a></code>,
especially <code>overwrite = TRUE</code>, when needed</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Returns a data frame with final statistics of the partitions included
 in the final model</p>


<p>Writes on disk a data frame with mean statistics of the partitions
included in the final model</p>


<p>Writes on disk a set of ecological niche models (.tif files) in the
<code>final_dir</code> subfolder</p>


<p>If <code>png_final = TRUE</code> writes .png figures in the
<code>final_dir</code> subfolder</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>There are no references for Rd macro <code>\insertAllCites</code> on this help page.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/dismo/man/threshold.html" class="external-link">threshold</a></code>  in <span class="pkg">dismo</span> package</p>
<p><code><a href="https://rdrr.io/pkg/terra/man/writeRaster.html" class="external-link">writeRaster</a></code>  in <span class="pkg">raster</span> package</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># run setup_sdmdata</span></span></span>
<span class="r-in"><span><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">example_occs</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">sp_coord</span> <span class="op">&lt;-</span> <span class="va">example_occs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">sp_setup</span> <span class="op">&lt;-</span> <span class="fu"><a href="setup_sdmdata.html">setup_sdmdata</a></span><span class="op">(</span>species_name <span class="op">=</span> <span class="va">sp</span>,</span></span>
<span class="r-in"><span>                          occurrences <span class="op">=</span> <span class="va">sp_coord</span>,</span></span>
<span class="r-in"><span>                          predictors <span class="op">=</span> <span class="va">example_vars</span>,</span></span>
<span class="r-in"><span>                          clean_uni <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># run do_any</span></span></span>
<span class="r-in"><span><span class="va">sp_bioclim</span> <span class="op">&lt;-</span> <span class="fu"><a href="model_fit.html">do_any</a></span><span class="op">(</span>species_name <span class="op">=</span> <span class="va">sp</span>,</span></span>
<span class="r-in"><span>                     predictors <span class="op">=</span> <span class="va">example_vars</span>,</span></span>
<span class="r-in"><span>                     algorithm <span class="op">=</span> <span class="st">"bioclim"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># run final_model</span></span></span>
<span class="r-in"><span><span class="va">sp_final</span> <span class="op">&lt;-</span> <span class="fu">final_model</span><span class="op">(</span>species_name <span class="op">=</span> <span class="va">sp</span>,</span></span>
<span class="r-in"><span>                        algorithms <span class="op">=</span> <span class="st">"bioclim"</span>,</span></span>
<span class="r-in"><span>                        which_models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bin_consensus"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        consensus_level <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>                        overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://github.com/AndreaSanchezTapia" class="external-link">Andrea Sánchez-Tapia</a>, <a href="https://github.com/saramortara" class="external-link">Sara Mortara</a>, Diogo Rocha, Felipe Barros, Guilherme Gall.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

