<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Joins ENM from several partitions, creating a model per algorithm — final_model • modleR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Joins ENM from several partitions, creating a model per algorithm — final_model" />
<meta property="og:description" content="This function reads the models generated either by do_any or
do_many (i.e. one model per partition per algorithm) and
summarizes them into a final model for each species-algorithm combination.
All the final models are created from the mean of the raw continuous models
(raw_mean). From these means, several
outputs can be created, see which_models for details about
the final outputs available. The uncertainty between partitions, taken as
ranges (maximum - minimum values) between partitions may also be calculated.
Just as there are no silver bullets in correlative ecological niche
modeling, no method for presenting this models is always better
and these are only a subset of the possibilities." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162793833-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-162793833-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">modleR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/modleR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/articles/buffer_and_randomPoints.html">Testing background point generation in modleR</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Model-R/modleR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Joins ENM from several partitions, creating a model per algorithm</h1>
    <small class="dont-index">Source: <a href='https://github.com/Model-R/modleR/blob/master/R/final_model.R'><code>R/final_model.R</code></a></small>
    <div class="hidden name"><code>final_model.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function reads the models generated either by <code><a href='model_fit.html'>do_any</a></code> or
<code><a href='model_fit.html'>do_many</a></code> (i.e. one model per partition per algorithm) and
summarizes them into a final model for each species-algorithm combination.
All the final models are created from the mean of the raw continuous models
(<code>raw_mean</code>). From these means, several
outputs can be created, see <code>which_models</code> for details about
the final outputs available. The uncertainty between partitions, taken as
ranges (maximum - minimum values) between partitions may also be calculated.
Just as there are <em>no silver bullets in correlative ecological niche
modeling</em>, no method for presenting this models is always better
and these are only a subset of the possibilities.</p>
    </div>

    <pre class="usage"><span class='fu'>final_model</span>(<span class='no'>species_name</span>, <span class='kw'>algorithms</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>scale_models</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>consensus_level</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>models_dir</span> <span class='kw'>=</span> <span class='st'>"./models"</span>,
  <span class='kw'>final_dir</span> <span class='kw'>=</span> <span class='st'>"final_models"</span>, <span class='kw'>proj_dir</span> <span class='kw'>=</span> <span class='st'>"present"</span>,
  <span class='kw'>which_models</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"raw_mean"</span>), <span class='kw'>mean_th_par</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"spec_sens"</span>),
  <span class='kw'>uncertainty</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>png_final</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>sensitivity</span> <span class='kw'>=</span> <span class='fl'>0.9</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>species_name</th>
      <td><p>A character string with the species name. Because species
name will be used as a directory name, avoid non-ASCII characters, spaces and
punctuation marks.
Recommendation is to adopt "Genus_species" format. See names in
<code><a href='example_occs.html'>example_occs</a></code> as an example</p></td>
    </tr>
    <tr>
      <th>algorithms</th>
      <td><p>Character vector specifying which algorithms will be
processed. Note that it can have length &gt; 1, ex. <code><a href='https://rdrr.io/r/base/c.html'>c("bioclim", "rf")</a></code>.
Defaults to NULL: if no name is given it will process all algorithms present
in the evaluation files</p></td>
    </tr>
    <tr>
      <th>scale_models</th>
      <td><p>Logical. Whether input models should be scaled between 0
and 1</p></td>
    </tr>
    <tr>
      <th>consensus_level</th>
      <td><p>Which proportion of binary models will be kept when
creating <code>bin_consensus</code></p></td>
    </tr>
    <tr>
      <th>models_dir</th>
      <td><p>Character. Folder path where the input files are located</p></td>
    </tr>
    <tr>
      <th>final_dir</th>
      <td><p>Character. Name of the folder to save the output files. A
subfolder will be created, defaults to "final_model"</p></td>
    </tr>
    <tr>
      <th>proj_dir</th>
      <td><p>Character. The name of the subfolder with the projection.
Defaults to "present" but can be set according to the other projections (i.e.
to execute the function in projected models)</p></td>
    </tr>
    <tr>
      <th>which_models</th>
      <td><p>Which <code>final_model</code> will be used? Currently it can
be:</p><dl'>
  <dt><code>raw_mean</code></dt><dd><p>Continuous model generated by the mean of the raw
  models (scale from 0 to 1)</p></dd>
  <dt><code>raw_mean_th</code></dt><dd><p>Cuts the <code>raw_mean</code> by the mean of the
  threshold selected in <code>mean_th_par</code> to make a binary model</p></dd>
   <dt><code>raw_mean_cut</code></dt><dd><p>Recovers <code>raw_mean</code> values above the
   threshold selected in <code>mean_th_par</code>. Generates a continuous model
   above this threshold while keeping null values below it</p></dd>
  <dt><code>bin_mean</code></dt><dd><p>The mean of the binary models, created by cutting
  the raw mean models by the threshold selected in <code>mean_th_par</code>.
  Generates a model in a discrete scale (0 to 1 in 1/n intervals where n is
  the number of partitions)</p></dd>
  <dt><code>bin_consensus</code></dt><dd><p>The binary consensus from <code>bin_mean</code>.
  Parameter <code>consensus_level</code> must be defined, 0.5 means a majority
  consensus</p></dd>

</dl></td>
    </tr>
    <tr>
      <th>mean_th_par</th>
      <td><p>A threshold that will be used to cut the raw mean models
if <code>which_models</code> is set to "<code>raw_mean_th</code>" or to transform the raw
mean models into binary models if <code>which_models</code> is set to
"<code>bin_consensus</code>". Defaults to "<code>spec_sens</code>" but any <span class="pkg">dismo</span>
threshold can be used (see function <code><a href='https://rdrr.io/pkg/dismo/man/threshold.html'>threshold</a></code>):
"<code>kappa</code>", "<code>no_omission</code>", "<code>prevalence</code>",
"<code>equal_spec_sens</code>", "<code>sensitivity</code>"</p></td>
    </tr>
    <tr>
      <th>uncertainty</th>
      <td><p>Whether an uncertainty map, measured as range (max-min)
should be calculated</p></td>
    </tr>
    <tr>
      <th>png_final</th>
      <td><p>Logical. If <code>TRUE</code>, writes png files of the final
models</p></td>
    </tr>
    <tr>
      <th>sensitivity</th>
      <td><p>The sensitivity value for threshold "<code>sensitivity</code>".
Defaults to 0.9</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other parameters from <code><a href='https://rdrr.io/pkg/raster/man/writeRaster.html'>writeRaster</a></code>,
especially <code>overwrite = TRUE</code>, when needed</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a data frame with final statistics of the partitions included
 in the final model</p>
<p>Writes on disk a data frame with mean statistics of the partitions
included in the final model</p>
<p>Writes on disk a set of ecological niche models (.tif files) in the
<code>final_dir</code> subfolder</p>
<p>If <code>png_final = TRUE</code> writes .png figures in the
<code>final_dir</code> subfolder</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>There are no references for Rd macro <code>\insertAllCites</code> on this help page.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/dismo/man/threshold.html'>threshold</a></code>  in <span class="pkg">dismo</span> package</p>
<p><code><a href='https://rdrr.io/pkg/raster/man/writeRaster.html'>writeRaster</a></code>  in <span class="pkg">raster</span> package</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># run setup_sdmdata</span>
<span class='no'>sp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>example_occs</span>)[<span class='fl'>1</span>]
<span class='no'>sp_coord</span> <span class='kw'>&lt;-</span> <span class='no'>example_occs</span><span class='kw'>[[</span><span class='fl'>1</span>]]
<span class='no'>sp_setup</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='setup_sdmdata.html'>setup_sdmdata</a></span>(<span class='kw'>species_name</span> <span class='kw'>=</span> <span class='no'>sp</span>,
                          <span class='kw'>occurrences</span> <span class='kw'>=</span> <span class='no'>sp_coord</span>,
                          <span class='kw'>predictors</span> <span class='kw'>=</span> <span class='no'>example_vars</span>)</div><div class='output co'>#&gt; <span class='message'>metadata file found, checking metadata</span></div><div class='output co'>#&gt; <span class='message'>same metadata, no need to run data partition</span></div><div class='input'>
<span class='co'># run do_any</span>
<span class='no'>sp_bioclim</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='model_fit.html'>do_any</a></span>(<span class='kw'>species_name</span> <span class='kw'>=</span> <span class='no'>sp</span>,
                     <span class='kw'>predictors</span> <span class='kw'>=</span> <span class='no'>example_vars</span>,
                     <span class='kw'>algorithm</span> <span class='kw'>=</span> <span class='st'>"bioclim"</span>)</div><div class='output co'>#&gt; <span class='message'>bioclim</span></div><div class='output co'>#&gt; <span class='message'>Abarema_langsdorffii bioclim run number 1 part. nb. 1</span></div><div class='output co'>#&gt; <span class='message'>fitting models</span></div><div class='output co'>#&gt; <span class='message'>projecting the models</span></div><div class='output co'>#&gt; <span class='message'>evaluating the models</span></div><div class='output co'>#&gt; <span class='message'>writing evaluation tables</span></div><div class='output co'>#&gt; <span class='message'>writing raster files</span></div><div class='input'>
<span class='co'># run final_model</span>
<span class='no'>sp_final</span> <span class='kw'>&lt;-</span> <span class='fu'>final_model</span>(<span class='kw'>species_name</span> <span class='kw'>=</span> <span class='no'>sp</span>,
                        <span class='kw'>algorithms</span> <span class='kw'>=</span> <span class='st'>"bioclim"</span>,
                        <span class='kw'>which_models</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"bin_consensus"</span>),
                        <span class='kw'>consensus_level</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
                        <span class='kw'>overwrite</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; [1] "Sat Apr  4 20:34:15 2020"</div><div class='output co'>#&gt; <span class='message'>Abarema_langsdorffii</span></div><div class='output co'>#&gt; <span class='message'>Reading evaluation files for Abarema_langsdorffii in present</span></div><div class='output co'>#&gt; <span class='message'>Extracting data for Abarema_langsdorffii bioclim</span></div><div class='output co'>#&gt; <span class='message'>Reading models from .tif files</span></div><div class='output co'>#&gt; <span class='message'>1 / 1 partitions will be used for Abarema_langsdorffii bioclim</span></div><div class='output co'>#&gt; <span class='warning'>Warning: when only one partition is selected the final models</span>
#&gt; <span class='warning'>                          are identical to the original model</span></div><div class='output co'>#&gt; <span class='message'>Standardizing models from 0 to 1</span></div><div class='output co'>#&gt; <span class='message'>selected final models for Abarema_langsdorffii bioclim DONE</span></div><div class='output co'>#&gt; <span class='message'>Writing models bioclim</span></div><div class='output co'>#&gt; <span class='message'>writing metadata</span></div><div class='output co'>#&gt; [1] "DONE bioclim !"</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://github.com/AndreaSanchezTapia'>Andrea Sánchez-Tapia</a>, <a href='https://github.com/saramortara'>Sara Mortara</a>, Diogo Rocha, Felipe Barros, Guilherme Gall.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


