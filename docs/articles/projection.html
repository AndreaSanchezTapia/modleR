<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Projecting models in modleR • modleR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Projecting models in modleR">
<meta property="og:description" content="modleR">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">modleR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/modleR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/buffer_and_randomPoints.html">Testing background point generation in modleR</a>
    </li>
    <li>
      <a href="../articles/projection.html">Projecting models in modleR</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Model-R/modleR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Projecting models in modleR</h1>
                        <h4 data-toc-skip class="author">Andrea
Sánchez-Tapia</h4>
            
            <h4 data-toc-skip class="date">2023-08-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Model-R/modleR/blob/HEAD/vignettes/articles/projection.Rmd" class="external-link"><code>vignettes/articles/projection.Rmd</code></a></small>
      <div class="hidden name"><code>projection.Rmd</code></div>

    </div>

    
    
<p>Here we explain the setup for projecting models in
<strong>modleR</strong>.</p>
<p>Loading required packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.rforge.net/rJava/" class="external-link">rJava</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">maps</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://maptools.r-forge.r-project.org/" class="external-link">maptools</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: multiple methods tables found for 'elide'</span></span></code></pre>
<div class="section level2">
<h2 id="selecting-one-species-as-an-example">Selecting one species as an example<a class="anchor" aria-label="anchor" href="#selecting-one-species-as-an-example"></a>
</h2>
<p>We use the standard dataset inside the package <code>modleR</code>.
First, from <code>example_occs</code> object we select only data from
one species <em>Abarema langsdorffii</em> and create one training set
(70% of the data) and one test set (30% of the data) for the data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Creating an object with species names</span></span>
<span><span class="va">especies</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">example_occs</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co"># Selecting only coordinates for the first species</span></span>
<span><span class="va">coord1sp</span> <span class="op">&lt;-</span> <span class="va">example_occs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">coord1sp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                       sp     lon     lat</span></span>
<span><span class="co">## 343 Abarema_langsdorffii -40.615 -19.921</span></span>
<span><span class="co">## 344 Abarema_langsdorffii -40.729 -20.016</span></span>
<span><span class="co">## 345 Abarema_langsdorffii -41.174 -20.303</span></span>
<span><span class="co">## 346 Abarema_langsdorffii -41.740 -20.493</span></span>
<span><span class="co">## 347 Abarema_langsdorffii -42.482 -20.701</span></span>
<span><span class="co">## 348 Abarema_langsdorffii -40.855 -17.082</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">coord1sp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 104   3</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Subsetting data into training and test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fl">0.7</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">coord1sp</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 73</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Making a sample of 70% of species' records</span></span>
<span><span class="va">set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">coord1sp</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fl">0.7</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">coord1sp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Creating training data set (70% of species' records)</span></span>
<span><span class="va">train_set</span> <span class="op">&lt;-</span> <span class="va">coord1sp</span><span class="op">[</span><span class="va">set</span>,<span class="op">]</span></span>
<span><span class="co"># Creating test data set (other 30%)</span></span>
<span><span class="va">test_set</span> <span class="op">&lt;-</span> <span class="va">coord1sp</span><span class="op">[</span><span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">coord1sp</span><span class="op">)</span>, <span class="va">set</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<p>Now lets the check our data points. We plot the traning and test data
sets with the first axis of the environmental PCA data from the object
<code>example_vars</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># selecting only the first PCA axis</span></span>
<span><span class="va">predictor</span> <span class="op">&lt;-</span> <span class="va">example_vars</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co"># transforming the data frame with the coordinates in a spatial object</span></span>
<span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPoints</a></span><span class="op">(</span><span class="va">coord1sp</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># ploting environmental layer</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">predictor</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">lat</span> <span class="op">~</span> <span class="va">lon</span>, data <span class="op">=</span> <span class="va">coord1sp</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></code></pre></div>
<p><img src="projection_files/figure-html/plotdataset-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="fitting-and-projection-datasets">Fitting and projection datasets<a class="anchor" aria-label="anchor" href="#fitting-and-projection-datasets"></a>
</h2>
<p>We want to fit everything in a small area around the occurrence
points and project it to other sample rasterStack objects.</p>
<p>The structure of folder for projections in modleR is key for this
step. In this example we have a folder with environmental data
<code>"./env"</code>. The period means “the current working directory”
so this is a subfolder, in this case it is besides the folder where the
model outputs are created <code>("./models_dir")</code> by default.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">current_wd</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="ex">├──</span> models_dir etc...</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="ex">└──</span> env</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>    <span class="ex">├──</span> cropped_proj.tif</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>    <span class="ex">└──</span> proj/</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>        <span class="ex">├──</span> proj1/</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>        <span class="ex">│</span>     ├ var01.tif</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>        <span class="ex">│</span>     ├ var02.tif</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>        <span class="ex">│</span>     ├ var03.tif</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>        <span class="ex">│</span>     └ var04.tif</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>        <span class="ex">├──</span> proj2/</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>        <span class="ex">│</span>     ├ var01.tif</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>        <span class="ex">│</span>     ├ var02.tif</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>        <span class="ex">│</span>     ├ var03.tif</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>        <span class="ex">│</span>     └ var04.tif</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>        <span class="ex">├──</span> proj3/</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>        <span class="ex">│</span>     ├ var01.tif</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>        <span class="ex">│</span>     ├ var02.tif</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>        <span class="ex">│</span>     ├ var03.tif</span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>        <span class="ex">│</span>     └ var04.tif</span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>        <span class="ex">└──</span> proj4/</span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>              <span class="ex">├</span> var01.tif</span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>              <span class="ex">├</span> var02.tif</span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a>              <span class="ex">├</span> var03.tif</span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>              <span class="ex">└</span> var04.tif</span></code></pre></div>
<p>Note that in this subfolder every projection has its own subfolder,
and that all variables have the same names. You can put all the
variables (from bio01 to bio19 in Worldclim, for example) and if there’s
a variable selection within <code><a href="../reference/model_fit.html">do_any()</a></code> the function will use
only the selected variables too.</p>
<p>For performing projections in modleR you only need to pass the
address of the folder where the projection variables are
<code>proj_data_folder = "./env/proj"</code> and set
<code>project_model = TRUE</code>.</p>
<p>We show here the example dataset and one of the projections
(<code>proj1</code>)</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="st">"./data/env/cropped_proj.tif"</span><span class="op">)</span></span>
<span><span class="va">proj_folder</span> <span class="op">&lt;-</span> <span class="st">"./data/env/proj/proj1/"</span></span>
<span><span class="va">proj_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">proj_folder</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="va">.</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPoints</a></span><span class="op">(</span><span class="va">coord1sp</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">example_vars</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, add <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">proj_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="projection_files/figure-html/dataset2-1.png" width="576"></p>
<p>Models will be fit in the area of the Brazilian Atlantic Forest and
projected to the Northern Andes in Colombia.</p>
<div class="section level3">
<h3 id="model-projection">Model projection<a class="anchor" aria-label="anchor" href="#model-projection"></a>
</h3>
<div class="section level4">
<h4 id="a-simple-model-with-no-buffer-and-no-projection">A simple model with no buffer and no projection:<a class="anchor" aria-label="anchor" href="#a-simple-model-with-no-buffer-and-no-projection"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generating sdmdata</span></span>
<span><span class="va">sdm_no_proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setup_sdmdata.html">setup_sdmdata</a></span><span class="op">(</span>species_name <span class="op">=</span> <span class="va">especies</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>                             occurrences <span class="op">=</span> <span class="va">coord1sp</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                             predictors<span class="op">=</span><span class="va">fit_data</span>, </span>
<span>                             models_dir<span class="op">=</span><span class="st">"./projections/"</span>, </span>
<span>                             clean_dupl <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                             clean_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># running models</span></span>
<span><span class="va">no_proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_fit.html">do_any</a></span><span class="op">(</span>species_name <span class="op">=</span> <span class="va">especies</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                   predictors <span class="op">=</span> <span class="va">fit_data</span>,</span>
<span>                   models_dir <span class="op">=</span> <span class="st">"./projections/"</span>,</span>
<span>                   algorithm <span class="op">=</span> <span class="st">"svme"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: `mutate_()` was deprecated in dplyr 0.7.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `mutate()` instead.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> See vignette('programming') for more help</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">kuenm</span> package.</span></span>
<span><span class="co">##   Please report the issue to the authors.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">no_proj.bc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span><span class="st">"./projections/Abarema_langsdorffii/present/partitions/svme_cont_Abarema_langsdorffii_1_1.tif"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">no_proj.bc</span><span class="op">)</span></span>
<span><span class="fu">maps</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/maps/man/map.html" class="external-link">map</a></span><span class="op">(</span>, , add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="projection_files/figure-html/enm1-1.png" width="576"></p>
</div>
<div class="section level4">
<h4 id="projections">Projections<a class="anchor" aria-label="anchor" href="#projections"></a>
</h4>
<p>We make a series of projections in the specified folder:
<code>"./env/proj"</code>. We use function <code><a href="../reference/model_fit.html">do_any()</a></code> and
algorithm svme in this example:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"proj1_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="co"># this is just to make sure that all current layers have the same names of the projectio variables.</span></span>
<span></span>
<span><span class="va">sdm_yes_proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setup_sdmdata.html">setup_sdmdata</a></span><span class="op">(</span>species_name <span class="op">=</span> <span class="va">especies</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                              occurrences <span class="op">=</span> <span class="va">coord1sp</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                              predictors <span class="op">=</span> <span class="va">fit_data</span>,</span>
<span>                              models_dir <span class="op">=</span> <span class="st">"./projections/"</span>,</span>
<span>                              clean_dupl <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                              clean_na <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                              buffer_type <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>                              partition_type <span class="op">=</span> <span class="st">"bootstrap"</span>,</span>
<span>                              boot_n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">yes_proj1</span> <span class="op">&lt;-</span> <span class="fu">modleR</span><span class="fu">::</span><span class="fu"><a href="../reference/model_fit.html">do_any</a></span><span class="op">(</span>species_name <span class="op">=</span> <span class="va">especies</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                            predictors <span class="op">=</span> <span class="va">fit_data</span>,</span>
<span>                            models_dir <span class="op">=</span> <span class="st">"./projections/"</span>,</span>
<span>                            algo <span class="op">=</span> <span class="st">"svme"</span>,</span>
<span>                            project_model <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            proj_data_folder <span class="op">=</span> <span class="st">"data/env/proj/"</span>,</span>
<span>                            png_partitions <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The same parameters would work when calling <code><a href="../reference/model_fit.html">do_many()</a></code>
(not run here)</p>
<p>We can plot the resulting projections. Note that this is one
projection per partition (n = 3).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html" class="external-link">include_graphics</a></span><span class="op">(</span><span class="st">"./projections/Abarema_langsdorffii/proj1/partitions/svme_cont_Abarema_langsdorffii_1_1.png"</span><span class="op">)</span></span></code></pre></div>
<p><img src="projections/Abarema_langsdorffii/proj1/partitions/svme_cont_Abarema_langsdorffii_1_1.png" width="240"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html" class="external-link">include_graphics</a></span><span class="op">(</span><span class="st">"./projections/Abarema_langsdorffii/proj1/partitions/svme_cont_Abarema_langsdorffii_2_1.png"</span><span class="op">)</span></span></code></pre></div>
<p><img src="projections/Abarema_langsdorffii/proj1/partitions/svme_cont_Abarema_langsdorffii_2_1.png" width="240"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html" class="external-link">include_graphics</a></span><span class="op">(</span><span class="st">"./projections/Abarema_langsdorffii/proj1/partitions/svme_cont_Abarema_langsdorffii_3_1.png"</span><span class="op">)</span></span></code></pre></div>
<p><img src="projections/Abarema_langsdorffii/proj1/partitions/svme_cont_Abarema_langsdorffii_3_1.png" width="240"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="final-model-projection">Final model projection<a class="anchor" aria-label="anchor" href="#final-model-projection"></a>
</h2>
<p><code><a href="../reference/final_model.html">final_model()</a></code> has a parameter <code>proj_dir</code> that
allows it to be run using any projection. Unlike <code><a href="../reference/model_fit.html">do_any()</a></code>
and <code><a href="../reference/model_fit.html">do_many()</a></code> this function needs to be run for each
projection. The default projection is <code>"present"</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">final_model_present</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/final_model.html">final_model</a></span><span class="op">(</span>species_name <span class="op">=</span> <span class="va">especies</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                                   models_dir <span class="op">=</span> <span class="st">"./projections/"</span>,</span>
<span>                                   proj_dir <span class="op">=</span> <span class="st">"present"</span>, </span>
<span>                                   overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Thu Aug  3 11:12:33 2023"</span></span></code></pre>
<pre><code><span><span class="co">## [1] "DONE svme !"</span></span></code></pre>
<p>For the projected models, each <code>proj_dir</code> has to have the
name of the projection</p>
<div class="section level4">
<h4 id="proj1">Proj1<a class="anchor" aria-label="anchor" href="#proj1"></a>
</h4>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">final_model_proj1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/final_model.html">final_model</a></span><span class="op">(</span>species_name <span class="op">=</span> <span class="va">especies</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                                 models_dir <span class="op">=</span> <span class="st">"./projections/"</span>,</span>
<span>                                 proj_dir <span class="op">=</span> <span class="st">"proj1"</span>,</span>
<span>                                 overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Thu Aug  3 11:12:37 2023"</span></span></code></pre>
<pre><code><span><span class="co">## [1] "DONE svme !"</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html" class="external-link">include_graphics</a></span><span class="op">(</span><span class="st">"./projections/Abarema_langsdorffii/proj1/final_models/Abarema_langsdorffii_svme_raw_mean.png"</span><span class="op">)</span></span></code></pre></div>
<p><img src="projections/Abarema_langsdorffii/proj1/final_models/Abarema_langsdorffii_svme_raw_mean.png" width="240"></p>
</div>
<div class="section level4">
<h4 id="proj2">Proj2<a class="anchor" aria-label="anchor" href="#proj2"></a>
</h4>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">final_model_proj2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/final_model.html">final_model</a></span><span class="op">(</span>species_name <span class="op">=</span> <span class="va">especies</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                                 models_dir <span class="op">=</span> <span class="st">"./projections/"</span>,</span>
<span>                                 proj_dir <span class="op">=</span> <span class="st">"proj2"</span>,</span>
<span>                                 overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Thu Aug  3 11:12:38 2023"</span></span></code></pre>
<pre><code><span><span class="co">## [1] "DONE svme !"</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html" class="external-link">include_graphics</a></span><span class="op">(</span><span class="st">"./projections/Abarema_langsdorffii/proj2/final_models/Abarema_langsdorffii_svme_raw_mean.png"</span><span class="op">)</span></span></code></pre></div>
<p><img src="projections/Abarema_langsdorffii/proj2/final_models/Abarema_langsdorffii_svme_raw_mean.png" width="240"></p>
</div>
<div class="section level4">
<h4 id="proj3">Proj3<a class="anchor" aria-label="anchor" href="#proj3"></a>
</h4>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">final_model_proj3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/final_model.html">final_model</a></span><span class="op">(</span>species_name <span class="op">=</span> <span class="va">especies</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                                 models_dir <span class="op">=</span> <span class="st">"./projections/"</span>,</span>
<span>                                 proj_dir <span class="op">=</span> <span class="st">"proj3"</span>,</span>
<span>                                 overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Thu Aug  3 11:12:43 2023"</span></span></code></pre>
<pre><code><span><span class="co">## [1] "DONE svme !"</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html" class="external-link">include_graphics</a></span><span class="op">(</span><span class="st">"./projections/Abarema_langsdorffii/proj3/final_models/Abarema_langsdorffii_svme_raw_mean.png"</span><span class="op">)</span></span></code></pre></div>
<p><img src="projections/Abarema_langsdorffii/proj3/final_models/Abarema_langsdorffii_svme_raw_mean.png" width="240"></p>
</div>
<div class="section level4">
<h4 id="proj4">Proj4<a class="anchor" aria-label="anchor" href="#proj4"></a>
</h4>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">final_model_proj4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/final_model.html">final_model</a></span><span class="op">(</span>species_name <span class="op">=</span> <span class="va">especies</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                                 models_dir <span class="op">=</span> <span class="st">"./projections/"</span>,</span>
<span>                                 proj_dir <span class="op">=</span> <span class="st">"proj4"</span>,</span>
<span>                                 overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Thu Aug  3 11:12:47 2023"</span></span></code></pre>
<pre><code><span><span class="co">## [1] "DONE svme !"</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html" class="external-link">include_graphics</a></span><span class="op">(</span><span class="st">"./projections/Abarema_langsdorffii/proj4/final_models/Abarema_langsdorffii_svme_raw_mean.png"</span><span class="op">)</span></span></code></pre></div>
<p><img src="projections/Abarema_langsdorffii/proj4/final_models/Abarema_langsdorffii_svme_raw_mean.png" width="240"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://github.com/AndreaSanchezTapia" class="external-link">Andrea Sánchez-Tapia</a>, <a href="https://github.com/saramortara" class="external-link">Sara Mortara</a>, Diogo Rocha, Felipe Barros, Guilherme Gall.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
